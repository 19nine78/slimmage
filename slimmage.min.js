/* Slimmage 0.2, use with ImageResizer. MIT/Apache2 dual licensed by Imazen */

(function(e){function p(){"undefined"!=typeof e.console&&a.verbose&&e.console.log.apply(e.console,arguments)}var a=window.slimmage||{};window.slimmage=a;void 0===a.verbose&&(a.verbose=!0);void 0===a.tryWebP&&(a.tryWebP=!1);a.h=function(){if(a.tryWebP&&!a.e){a.e=!0;var d=new Image;d.onload=d.onerror=function(){a.d=2==d.height};d.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}};a.j=function(a){var b="undefined"!=typeof window.getComputedStyle&&
window.getComputedStyle(a,null).getPropertyValue("max-width");!b&&a.currentStyle&&(b=a.currentStyle["max-width".replace(/([a-z])\-([a-z])/,function(a,d,b){return d+b.toUpperCase()})]||a.currentStyle["max-width"]);return b};a.i=function(d){var b=a.j(d);if("px"==b.slice(-2))return parseFloat(b.slice(0,-2));var c=document.createElement("div");c.style.overflow=c.style.visibility="hidden";d.parentNode.appendChild(c);c.style.width=b;b=c.offsetWidth;d.parentNode.removeChild(c);return b};a.c=function(a){for(var b=
[],c=a.length>>>0;c--;)b[c]=a[c];return b};a.g=function(d,b,c){var f=window.devicePixelRatio||1,e=1.49<f?90:80;a.d&&(e=1.49<f?65:78);c=Math.min(2048,c*f);c=c-c%160+160;f=d.getAttribute("data-pixel-width")|0;c>f&&(b=b.replace(/width=\d+/i,"width="+c).replace(/quality=[0-9]+/i,"quality="+e),a.d&&(b=b.replace(/format=[a-z]+/i,"format=webp")),d.src=b,d.setAttribute("data-pixel-width",c),p("Slimming: updating "+b))};a.f=function(d,b){a.g(d,b,a.i(d))};a.b=function(d){0<a.a&&e.clearTimeout(a.a);a.a=0;if(d&&
0<d)a.a=e.setTimeout(a.b,d);else{d=(new Date).getTime();for(var b=0,c=a.c(e.document.getElementsByTagName("noscript")),f=0,l=c.length;f<l;f++){var g=c[f];if(null!==g.getAttribute("data-slimmage")){var m=e.document.createElement("div"),k=g.textContent||g.innerHTML;if(k&&0!=k.replace(/[\s\t\r\n]+/,"").length)m.innerHTML=k.replace(/\s+src\s*=\s*(['"])/i," data-src=$1").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");else{for(var k=new Image,n=0;n<g.attributes.length;n++){var h=g.attributes[n];
h&&(h.specified&&0==h.name.indexOf("data-img-"))&&k.setAttribute(h.name.slice(9-h.name.length),h.value)}m.appendChild(k)}m=m.getElementsByTagName("img");k=0;for(n=m.length;k<n;k++)h=m[k],null!==h.src&&0<h.src.length&&(h.setAttribute("data-src",h.src),h.src=""),h.setAttribute("data-slimmage",!0),g.parentNode.insertBefore(h,g),b++;g.parentNode.removeChild(g)}}c=0;g=a.c(e.document.getElementsByTagName("img"));f=0;for(l=g.length;f<l;f++)null!==g[f].getAttribute("data-slimmage")&&(m=g[f].getAttribute("data-src")||
g[f].src,a.f(g[f],m),c++);p("Slimmage: restored "+b+" images from noscript tags; sizing "+c+" images. "+((new Date).getTime()-d)+"ms")}};var l=a.b;e.addEventListener?(e.addEventListener("resize",function(){l(500)},!1),e.addEventListener("DOMContentLoaded",function(){l();e.removeEventListener("load",l,!1)},!1),e.addEventListener("load",l,!1)):e.attachEvent&&e.attachEvent("onload",l);a.h()})(this);
