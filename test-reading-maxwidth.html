<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <title>Test cross-browser reading of max-width</title>
  <style type="text/css">
    #image1 { max-width: 20px;}
    #image2 {max-width:20%;}
    #image3 {max-width:2em;}
    #image4 {max-width:1cm;}
    #image5 {max-width:1in;}
  </style>
</head>

<body>
  <pre id="report"></pre>
  <img src="http://z.zr.io/ri/fix1.jpg" id="image1"/>
  <img src="http://z.zr.io/ri/fix1.jpg" id="image2"/>
  <img src="http://z.zr.io/ri/fix1.jpg" id="image3"/>
  <img src="http://z.zr.io/ri/fix1.jpg" id="image4"/>
  <img src="http://z.zr.io/ri/fix1.jpg" id="image5"/>
  <script type="text/javascript">

    var getCssValue = function(target, hyphenProp){
      var val = typeof(window.getComputedStyle) != "undefined" && window.getComputedStyle(target, null).getPropertyValue(hyphenProp);
      if (!val && target.currentStyle){
        val = target.currentStyle[hyphenProp.replace(/([a-z])\-([a-z])/, function(a,b,c){ return b + c.toUpperCase();})] || target.currentStyle[hyphenProp];
      }
      return val;
    };

    var checkStyle = function(calledBy){
      var r = document.getElementById("report");
      r.innerHTML += "\r\nCalled by " + (calledBy || "load") + "\r\n";
      for (var i =1; i < 6; i++){
          var img = document.getElementById("image" + i);
          r.innerHTML += getCssValue(img,"max-width") + "\t";

      } 
    };
    var h = checkStyle;
    var w = window;
    // Run on resize and domready (w.load as a fallback)
    if (w.addEventListener) {
        w.addEventListener("resize", function () { h("resize"); }, false);
        w.addEventListener("DOMContentLoaded", function () {
            h("domcontentloaded");
            // Run once only
            w.removeEventListener("load", h, false);
        }, false);
        w.addEventListener("load", h, false);
    } else if (w.attachEvent) {
        w.attachEvent("onload", function(){ h("onload"); });
    }

  </script>
